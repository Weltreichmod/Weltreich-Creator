on_actions = {
	on_startup = {
		effect = {
			# Setup up a player array
			every_country = {
				limit = { is_ai = no }
				set_country_flag = show_welcome_splash
			}
			FRA = {
				FRA_initialize_behind_the_curtain_of_power = yes
			}
		}
	}
	on_new_term_election = {
		random_events = {
			100 = south_africa_wr.7
		}
	}
	on_war = {
		effect = {
			if = {
				limit = {
					GER = {
						has_war_with = SOV
						is_subject = no
					}
				}
				SOV = { country_event = { id = soviet_rework_white.001 days = 3 } }
			}
			if = {
				limit = {
					FRA = {
						has_war_with = GER
						is_subject = no
					}
				}
				FRA = { country_event = { id = france_wr.1002 days = 42 } }
				FRA = { country_event = { id = france.100 days = 1 } }
			}
		}
	}
	on_weekly_FRA = {
		effect = {
			if = {
				limit = {
					NOT = {
						has_power_balance_modifier = {
							id = FRA_government_infiltration
							modifier = FRA_government_infiltration_doriot
						}
					}
				}
				add_power_balance_modifier = {
					id = FRA_government_infiltration
					modifier = FRA_government_infiltration_doriot
				}
			}
		}
		effect = {
			if = {
				limit = {
					NOT = {
						has_power_balance_modifier = {
							id = FRA_Political_Conflict
							modifier = FRA_government_to_right
						}
					}
					has_completed_focus = FRA_republic_of_fraternity
				}
				add_power_balance_modifier = {
					id = FRA_Political_Conflict
					modifier = FRA_government_to_right
				}
			}
			else_if = {
				limit = {
					NOT = {
						has_power_balance_modifier = {
							id = FRA_Political_Conflict
							modifier = FRA_government_to_left
						}
					}
					has_completed_focus = FRA_republic_of_liberty
				}
				add_power_balance_modifier = {
					id = FRA_Political_Conflict
					modifier = FRA_government_to_left
				}
			}
		}
	}
	on_monthly_FRA = {
		effect = {
			if = {
				limit = {
					FRA = {
						NOT = { has_country_flag = second_great_war_loser }
						has_government = democratic
						has_dynamic_modifier = {
							modifier = FRA_consumer_goods_factor_decision
						}
					}
				}
				set_variable = { FRA_civ_num = num_of_civilian_factories }
				set_variable = { FRA_mil_num = num_of_military_factories }
				set_variable = { FRA_civ_mil_ratio = FRA_mil_num }
				divide_variable = {
					var = FRA_civ_mil_ratio
					value = FRA_civ_num
				}
			}
		}
	}
	on_assume_faction_leadership = {
		effect = {
			if = {
				limit = {
					FROM = {
						tag = ENT
						has_idea = ENT_leader
					}
				}
				FROM = { remove_ideas = ENT_leader }
				save_global_event_target_as = leader_of_national_entente
				add_ideas = ENT_leader
			}
			if = {
				limit = {
					FROM = {
						tag = ENT
						has_idea = FRA_liberation_committee
					}
				}
				FROM = { remove_ideas = FRA_liberation_committee }
				save_global_event_target_as = leader_of_national_entente
				add_ideas = FRA_liberation_committee
			}
			if = {
				limit = { FROM = { tag = REI } }
				FROM = { remove_ideas = REI_leader }
				save_global_event_target_as = leader_of_reichspakt
				add_ideas = REI_leader
			}
			if = {
				limit = { FROM = { tag = UNF } }
				save_global_event_target_as = leader_of_United_Fronts
			}
		}
	}
	on_capitulation = {
		effect = {
			if = {
				limit = {
					original_tag = FRA
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_france_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_france_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = ENG
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_britain_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_britain_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = AUH
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_austria_hungary_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_austria_hungary_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = USA
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_usa_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_usa_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = ITA
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_italy_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_italy_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = TUR
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_ottoman_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_ottoman_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					OR  ={
						original_tag = CAN
						original_tag = AST
						original_tag = NZL
						original_tag = RAJ
					}
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						ROOT = { original_tag = CAN }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_canada_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_canada_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = { original_tag = AST }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_australia_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_australia_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = { original_tag = NZL }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_new_zealand_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_new_zealand_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = { original_tag = RAJ }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_raj_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_raj_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					OR  ={
						original_tag = IRE
						original_tag = DEN
						original_tag = NOR
						original_tag = SWE
						original_tag = FIN
					}
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						ROOT = { original_tag = IRE }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_ireland_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_ireland_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = { original_tag = DEN }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_denmark_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_denmark_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = { original_tag = NOR }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_norway_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_norway_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = { original_tag = SWE }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_sweden_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_sweden_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
				if = {
					limit = {
						ROOT = { original_tag = FIN }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_finland_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_finland_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = ROM
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						ROOT = { original_tag = ROM }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_romania_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_romania_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = BUL
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						ROOT = { original_tag = BUL }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_bulgaria_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_bulgaria_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = GRE
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						ROOT = { original_tag = GRE }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_greece_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_greece_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = SER
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						ROOT = { original_tag = SER }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_serbia_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_serbia_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					original_tag = ALB
					has_global_flag = second_world_war
				}
				if = {
					limit = {
						ROOT = { original_tag = ALB }
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_albania_flag }
					log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_albania_flag
						}
						log = "[GetDate] - ([Root.GetTag]): [ROOT.GetName] has fallen by [FROM.GetName]"
					}
				}
			}
			if = {
				limit = {
					SPA = { exists = yes }
				}
				if = {
					limit = {
						tag = SPA
						has_global_flag = second_world_war
					}
					if = {
						limit = {
							FROM = { is_subject = no }
						}
						FROM = { set_country_flag = defeat_spain_flag }
						else = {
							every_country = {
								limit = {
									has_subject = FROM
								}
								set_country_flag = defeat_spain_flag
							}
						}
					}
				}
				else_if = {
					limit = {
						SPR = { exists = yes }
					}
				}
				if = {
					limit = {
						tag = SPR
						has_global_flag = second_world_war
					}
					if = {
						limit = {
							FROM = { is_subject = no }
						}
						FROM = { set_country_flag = defeat_spain_flag }
						else = {
							every_country = {
								limit = {
									has_subject = FROM
								}
								set_country_flag = defeat_spain_flag
							}
						}
					}
				}
			}
			#Second Great War - Fall of Comintern by Reichspakt
            if = {
                limit = {
					original_tag = SOV
					any_enemy_country = {
						original_tag = GER
					}
					GER = { is_subject = no }
					has_global_flag = german_soviet_war
					NOT = {
						has_global_flag = german_soviet_war_ends
					}
                }
				every_country = {
					limit = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_winner
						}
					}
					set_country_flag = anti_russia_war_loser
				}
				every_country = {
					limit = {
						OR = {
							tag = FROM
							is_in_faction_with = FROM
							is_subject_of = FROM
							has_war_with = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_loser
						}
						NOT = {
							OR = {
								original_tag = GER
								is_in_faction_with = GER
								is_subject_of = GER
								original_tag = JAP
								is_in_faction_with = JAP
								is_subject_of = JAP
							}
						}
					}
					set_country_flag = anti_russia_war_winner
				}
				if = {
					limit = {
						MON = {
							is_in_faction_with = SOV
							OR = {
								has_war_with = GER
								has_war_with = JAP
							}
						}
					}
					MON = { set_country_flag = anti_russia_war_loser }
				}
				if = {
					limit = {
						USS = {
							is_in_faction_with = SOV
							OR = {
								has_war_with = GER
								has_war_with = JAP
							}
						}
					}
					USS = { set_country_flag = anti_russia_war_loser }
				}
				if = {
					limit = {
						UPR = {
							is_in_faction_with = SOV
							OR = {
								has_war_with = GER
								has_war_with = JAP
							}
						}
					}
					UPR = { set_country_flag = anti_russia_war_loser }
				}
				if = {
					limit = {
						TAN = {
							is_in_faction_with = SOV
							OR = {
								has_war_with = GER
								has_war_with = JAP
							}
						}
					}
					TAN = { set_country_flag = anti_russia_war_loser }
				}
				if = {
					limit = {
						JAP = {
							has_war_with = SOV
							has_capitulated = no
						}
					}
					JAP = { country_event = japan_wr.18 }
					set_global_flag = jap_vic_against_sov
				}
				SOV = {
					add_ideas = Treaty_of_Kazan1
					country_lock_all_division_template = yes
					if = {
						limit = {
							SOV = { NOT = { is_faction_leader = yes } }
						}
						every_country = {
							limit = {
								OR = {
									original_tag = SOV
									is_subject_of = SOV
								}
							}
							leave_faction = yes
						}
					}
					if = {
						limit = {
							SOV = { is_faction_leader = yes }
						}
						dismantle_faction = yes
					}
					remove_ideas = home_of_revolution
				}
				every_country = {
					limit = {
						has_war_with = SOV
					}
					white_peace = {
						tag = SOV
						message = unconditional_surrender_of_SOV
					}
				}
				if = {
					limit = {
						MON = { has_country_flag = anti_russia_war_loser }
					}
					every_country = {
						limit = {
							has_war_with = MON
						}
						white_peace = {
							tag = MON
						}
					}
				}
				if = {
					limit = {
						USS = { has_country_flag = anti_russia_war_loser }
					}
					every_country = {
						limit = {
							has_war_with = USS
						}
						white_peace = {
							tag = USS
						}
					}
				}
				if = {
					limit = {
						UPR = { has_country_flag = anti_russia_war_loser }
					}
					every_country = {
						limit = {
							has_war_with = UPR
						}
						white_peace = {
							tag = UPR
						}
					}
				}
				SOV = {
					annex_country = {
						target = SOV
						transfer_troops = yes
					}
				}
				GER = { country_event = Germany.71 }
				clr_global_flag = german_soviet_war
				set_global_flag = german_soviet_war_ends
				peace_conference_effect_for_russia = yes
			}
			#Second Great War - Fall of Comintern by Austria
            if = {
                limit = {
					original_tag = SOV
					any_enemy_country = {
						original_tag = AUH
					}
					AUH = { is_subject = no }
					GER = { is_subject_of = AUH }
					has_global_flag = german_soviet_war
					NOT = {
						has_global_flag = german_soviet_war_ends
					}
                }
				every_country = {
					limit = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_winner
						}
					}
					set_country_flag = anti_russia_war_loser
				}
				every_country = {
					limit = {
						OR = {
							tag = FROM
							is_in_faction_with = FROM
							is_subject_of = FROM
							has_war_with = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_loser
						}
						NOT = {
							OR = {
								original_tag = AUH
								is_in_faction_with = AUH
								is_subject_of = AUH
								original_tag = JAP
								is_in_faction_with = JAP
								is_subject_of = JAP
							}
						}
					}
					set_country_flag = anti_russia_war_winner
				}
				if = {
					limit = {
						MON = {
							is_in_faction_with = SOV
							OR = {
								has_war_with = AUH
								has_war_with = JAP
							}
						}
					}
					MON = { set_country_flag = anti_russia_war_loser }
				}
				if = {
					limit = {
						USS = {
							is_in_faction_with = SOV
							OR = {
								has_war_with = AUH
								has_war_with = JAP
							}
						}
					}
					USS = { set_country_flag = anti_russia_war_loser }
				}
				if = {
					limit = {
						UPR = {
							is_in_faction_with = SOV
							OR = {
								has_war_with = AUH
								has_war_with = JAP
							}
						}
					}
					UPR = { set_country_flag = anti_russia_war_loser }
				}
				if = {
					limit = {
						TAN = {
							is_in_faction_with = SOV
							OR = {
								has_war_with = AUH
								has_war_with = JAP
							}
						}
					}
					TAN = { set_country_flag = anti_russia_war_loser }
				}
				if = {
					limit = {
						JAP = {
							has_war_with = SOV
							has_capitulated = no
						}
					}
					JAP = { country_event = japan_wr.18 }
					set_global_flag = jap_vic_against_sov
				}
				SOV = {
					add_ideas = Treaty_of_Kazan1
					country_lock_all_division_template = yes
					if = {
						limit = {
							SOV = { NOT = { is_faction_leader = yes } }
						}
						every_country = {
							limit = {
								OR = {
									original_tag = SOV
									is_subject_of = SOV
								}
							}
							leave_faction = yes
						}
					}
					if = {
						limit = {
							SOV = { is_faction_leader = yes }
						}
						dismantle_faction = yes
					}
					remove_ideas = home_of_revolution
				}
				every_country = {
					limit = {
						has_war_with = SOV
					}
					white_peace = {
						tag = SOV
						message = unconditional_surrender_of_SOV
					}
				}
				if = {
					limit = {
						MON = { has_country_flag = anti_russia_war_loser }
					}
					every_country = {
						limit = {
							has_war_with = MON
						}
						white_peace = {
							tag = MON
						}
					}
				}
				if = {
					limit = {
						USS = { has_country_flag = anti_russia_war_loser }
					}
					every_country = {
						limit = {
							has_war_with = USS
						}
						white_peace = {
							tag = USS
						}
					}
				}
				if = {
					limit = {
						UPR = { has_country_flag = anti_russia_war_loser }
					}
					every_country = {
						limit = {
							has_war_with = UPR
						}
						white_peace = {
							tag = UPR
						}
					}
				}
				SOV = {
					annex_country = {
						target = SOV
						transfer_troops = yes
					}
				}
				clr_global_flag = german_soviet_war
				set_global_flag = german_soviet_war_ends
				peace_conference_effect_for_russia = yes
				every_country = {
					limit = {
						is_subject_of = SOV
					}
					country_event = Soviet.4
				}
				every_state = {
					limit = {
						is_claimed_by = SOV
					}
					remove_claim_by = SOV
				}
				every_state = {
					limit = {
						OR = {
							is_owned_by = GER
							is_owned_by = UBD
							is_owned_by = LAT
							is_owned_by = EST
							is_owned_by = LIT
							is_owned_by = POL
							is_owned_by = UKR
						}
					}
					remove_core_of = SOV
				}
				if = {
					limit = {
						UKR = {
							is_in_faction_with = AUH
							NOT = { has_country_flag = anti_russia_war_loser }
						}
					}
					every_state = {
						limit = {
							is_owned_by = SOV
							OR = {
								state = 988
								state = 245
								state = 218
								state = 260
								state = 220
							}
						}
						transfer_state_to = UKR
					}
				}
				if = {
					limit = {
						USS = {
							is_in_faction_with = AUH
							NOT = { has_country_flag = anti_russia_war_loser }
						}
					}
					every_state = {
						limit = {
							is_owned_by = SOV
							OR = {
								state = 988
								state = 245
								state = 218
								state = 260
								state = 220
							}
						}
						transfer_state_to = USS
					}
				}
				if = {
					limit = {
						UPR = {
							is_in_faction_with = AUH
							NOT = { has_country_flag = anti_russia_war_loser }
						}
					}
					every_state = {
						limit = {
							is_owned_by = SOV
							OR = {
								state = 988
								state = 245
								state = 218
								state = 260
								state = 220
							}
						}
						transfer_state_to = UPR
					}
				}
				RUS = {
					set_country_flag = no_focus
					remove_country_leader_role = {
						character = RUS_aleksey_arkhangelsky
						ideology = despotism
					}
					add_country_leader_role = {
						character = RUS_vladimir_kirillovich
						promote_leader = yes
						country_leader = {
							ideology = autocracy
						}
					}
					set_cosmetic_tag = RUS_kingdom
				}
				every_state = {
					limit = {
						is_owned_by = SOV
						OR = {
							state = 195
							state = 208
							state = 244
							state = 209
							state = 263
							state = 210
							state = 246
							state = 242
							state = 243
							state = 247
							state = 264
							state = 214
							state = 219
							state = 205
							state = 248
							state = 250
							state = 253
							state = 224
							state = 254
							state = 256
							state = 223
							state = 222
							state = 258
							state = 257
							state = 252
							state = 255
							state = 239
							state = 265
							state = 351
							state = 829
							state = 879
							state = 880
							state = 401
							state = 251
							state = 249
							state = 652
							state = 833
							state = 400
							state = 397
							state = 651
							state = 399
							state = 398
							state = 582
							state = 573
							state = 262
							state = 958
							state = 825
							state = 581
							state = 407
							state = 406
							state = 217
							state = 245
							state = 218
							state = 236
							state = 237
							state = 238
							state = 234
							state = 235
							state = 233
							state = 827
							state = 828
							state = 232
							state = 821
						}
					}
					add_core_of = RUS
					transfer_state_to = RUS
				}
				if = {
					limit = {
						RUS = { exists = yes }
					}
					AUH = {
						if = {
							limit = {
								has_dlc = "Together for Victory"
							}
							set_autonomy = {
								target = RUS
								autonomous_state = autonomy_puppet
								freedom_level = 0.5
							}
							else = {
								puppet = RUS
							}
						}
						add_to_faction = RUS
					}
				}
				if = {
					limit = {
						FIN = {
							NOT = {
								is_in_faction_with = GER
								has_country_flag = FIN_claim_Karelia
							}
						}
					}
					every_state = {
						limit = {
							is_owned_by = SOV
							OR = {
								state = 213
								state = 215
								state = 216
							}
						}
						add_core_of = RUS
						transfer_state_to = RUS
					}
					else = {
						every_state = {
							limit = {
								is_owned_by = SOV
								OR = {
									is_claimed_by = FIN
									state = 213
									state = 215
									state = 216
								}
							}
							transfer_state_to = FIN
						}
					}
				}
				931 = { transfer_state_to = BLR }
				207 = { transfer_state_to = BLR }
				810 = { transfer_state_to = UBD }
				every_state = {
					limit = {
						is_owned_by = SOV
						is_core_of = KAZ
					}
					transfer_state_to = KAZ
				}
				every_state = {
					limit = {
						is_owned_by = SOV
						is_core_of = TUK
					}
					transfer_state_to = TUK
				}
				every_state = {
					limit = {
						OR = {
							is_owned_by = SOV
							is_owned_by = USS
							is_owned_by = UPR
						}
						OR = {
							state = 94
							state = 194
							state = 241
						}
					}
					transfer_state_to = BLR
				}
				every_state = {
					limit = {
						OR = {
							is_owned_by = SOV
							is_owned_by = USS
							is_owned_by = UPR
						}
						OR = {
							state = 913
						}
					}
					transfer_state_to = POL
				}
				if = {
					limit = {
						USS = { has_country_flag = anti_russia_war_loser }
						USS = { exists = yes }
					}
					UKR = { annex_country = { target = USS transfer_troops = yes } }
					AUH = {
						if = {
							limit = {
								OR = {
									has_dlc = "Together for Victory"
									has_dlc = "Waking the Tiger"
								}
							}
							set_autonomy = {
								target = UKR
								autonomous_state = autonomy_protected_state
								freedom_level = 0.5
							}
							else = {
								puppet = UKR
							}
						}
					}
					every_state = {
						limit = {
							is_owned_by = USS
							OR = {
								state = 94
								state = 194
							}
						}
						add_core_of = BLR
						remove_core_of = USS
						transfer_state_to = BLR
					}
					every_state = {
						limit = {
							is_owned_by = USS
							state = 913
						}
						add_core_of = POL
						remove_core_of = USS
						transfer_state_to = POL
					}
					every_state = {
						limit = {
							is_owned_by = SOV
							OR = {
								state = 988
								state = 260
								state = 220
							}
						}
						transfer_state_to = RUS
						add_core_of = RUS
					}
				}
				if = {
					limit = {
						UPR = { has_country_flag = anti_russia_war_loser }
						UPR = { exists = yes }
					}
					UKR = { annex_country = { target = UPR transfer_troops = yes } }
					AUH = {
						if = {
							limit = {
								OR = {
									has_dlc = "Together for Victory"
									has_dlc = "Waking the Tiger"
								}
							}
							set_autonomy = {
								target = UKR
								autonomous_state = autonomy_protected_state
								freedom_level = 0.5
							}
							else = {
								puppet = UKR
							}
						}
					}
					every_state = {
						limit = {
							is_owned_by = UPR
							OR = {
								state = 94
								state = 194
							}
						}
						add_core_of = BLR
						remove_core_of = UPR
						transfer_state_to = BLR
					}
					every_state = {
						limit = {
							is_owned_by = UPR
							state = 913
						}
						add_core_of = POL
						remove_core_of = UPR
						transfer_state_to = POL
					}
					every_state = {
						limit = {
							is_owned_by = SOV
							OR = {
								state = 988
								state = 260
								state = 220
							}
						}
						transfer_state_to = RUS
						add_core_of = RUS
					}
				}
				SOV = {
					set_capital = {
					  state = 571
					  remember_old_capital = no
					}
					mark_focus_tree_layout_dirty = yes
					country_event = { id = soviet_rework_troika.038 days = 25 }
					complete_national_focus = SOV_the_war_has_been_lost
				}
			}
			#Second Great War - Fall of Russia by Reichspakt
            if = {
                limit = {
					original_tag = RUS
					any_enemy_country = {
						original_tag = GER
					}
					GER = { is_subject = no }
					has_global_flag = german_russian_war
					NOT = {
						has_global_flag = german_russian_war_ends
					}
                }
				RUS = {
					#add_ideas = Treaty_of_Nizhny_Novgorod
					remove_ideas = country_isolation
					country_lock_all_division_template = yes
					set_country_flag = anti_russia_war_loser_mk_two
				}
				every_country = {
					limit = {
						has_war_with = RUS
					}
					white_peace = {
						tag = RUS
						message = unconditional_surrender_of_RUS
					}
				}
				if = {
					limit = {
						MOS = { exists = no }
					}
					GER = {
						if = {
							OR = {
								has_dlc = "Together for Victory"
								has_dlc = "Waking the Tiger"
							}
							set_autonomy = {
								target = MOS
								autonomous_state = autonomy_oberbefehlshaberiat
								freedom_level = 0.5
							}
							else = {
								puppet = MOS
							}
						}
					}
					MOS = {
						inherit_technology = RUS
						annex_country = {
							target = RUS
							transfer_troops = no
						}
					}
				}
				if = {
					limit = {
						URL = { exists = no }
					}
					GER = {
						if = {
							limit = {
								OR = {
									has_dlc = "Together for Victory"
									has_dlc = "Waking the Tiger"
								}
							}
							set_autonomy = {
								target = URL
								autonomous_state = autonomy_Military_District
								freedom_level = 0.3
							}
							else = {
								puppet = URL
							}
						}
					}
					URL = { inherit_technology = RUS }
					every_state = {
						limit = {
							is_owned_by = MOS
							OR = {
								state = 401
								state = 251
								state = 249
								state = 652
								state = 833
								state = 400
								state = 397
								state = 651
								state = 399
								state = 398
								state = 582
								state = 573
								state = 262
								state = 958
								state = 825
								state = 581
							}
						}
						add_core_of = URL
					}
					every_state = {
						limit = {
							is_core_of = URL
						}
						transfer_state_to = URL
					}
				}
				every_state = {
					limit = {
						is_owned_by = MOS
						OR = {
							state = 406
							state = 407
						}
					}
					transfer_state_to = WOL
					add_core_of = WOL
				}
				every_state = {
					limit = {
						is_owned_by = MOS
					}
					add_core_of = MOS
				}
				#else = {
				#	GER = {
				#		if = {
				#			OR = {
				#				has_dlc = "Together for Victory"
				#				has_dlc = "Waking the Tiger"
				#			}
				#			set_autonomy = {
				#				target = RUS
				#				autonomous_state = autonomy_cooperating_country
				#				freedom_level = 0.2
				#			}
				#			else = {
				#				puppet = RUS
				#			}
				#		}
				#	}
				#}
				#GER = { country_event = Germany.88 }
				clr_global_flag = german_russian_war
				set_global_flag = german_russian_war_ends
			}
			#fall of Germany by sov
			if = {
                limit = {
					original_tag = GER
					any_enemy_country = {
						original_tag = SOV
					}
					has_global_flag = german_soviet_war
					NOT = {
						has_global_flag = german_soviet_war_ends
					}
                }
				every_country = {
					limit = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_winner
						}
					}
					set_country_flag = anti_russia_war_loser
				}
				every_country = {
					limit = {
						OR = {
							tag = FROM
							is_subject_of = FROM
						}
						NOT = {
							has_country_flag = anti_russia_war_loser
						}
					}
					set_country_flag = anti_russia_war_winner
				}
				if = {
					limit = {
						OR = {
							SOV = { has_country_flag = anti_russia_war_loser }
							AND = {
								NOT = { ENT = { has_war_with = REI } }
								SOV = { has_country_flag = anti_russia_war_winner }
							}
						}
					}
					#every_country = {
					#	limit = {
					#		has_war_with = GER
					#		NOT = { has_country_flag = anti_russia_war_loser }
					#		NOT = { has_country_flag = anti_russia_war_winner }
					#	}
					#	set_country_flag = anti_russia_war_winner
					#}
					#peace_conference_effect_for_russia = yes
				}
			}
			#fall of Germany by rus
			if = {
                limit = {
					original_tag = GER
					any_enemy_country = {
						original_tag = RUS
					}
					has_global_flag = german_russian_war
					NOT = {
						has_global_flag = german_russian_war_ends
					}
                }
				news_event = soviet_rework_white.065
				RUS = { remove_ideas = country_isolation }
				every_country = {
					limit = {
						OR = {
							tag = ROOT
							is_subject_of = ROOT
						}
						NOT = {
							has_country_flag = anti_russia_war_winner
						}
					}
					set_country_flag = anti_russia_war_loser
				}
				every_country = {
					limit = {
						OR = {
							tag = FROM
							is_in_faction_with = FROM
							is_subject_of = FROM
						}
						NOT = {
							has_country_flag = anti_russia_war_loser
						}
					}
					set_country_flag = anti_russia_war_winner
				}
				if = {
					limit = {
						OR = {
							RUS = { has_country_flag = anti_russia_war_loser }
							AND = {
								NOT = { ENT = { has_war_with = REI } }
								RUS = { has_country_flag = anti_russia_war_winner }
							}
						}
					}
					#every_country = {
					#	limit = {
					#		has_war_with = GER
					#		NOT = { has_country_flag = anti_russia_war_loser }
					#		NOT = { has_country_flag = anti_russia_war_winner }
					#	}
					#	set_country_flag = anti_russia_war_winner
					#}
					#peace_conference_effect_for_russia = yes
				}
			}
			if = {
				limit = {
					ROOT = { has_country_flag = defeat_france_flag }
				}
				if = {
					limit = {
						FRA = { has_country_flag = second_great_war_loser }
					}
					every_state = {
						limit = {
							is_owned_by = ROOT
							is_core_of = FRA
							NOT = { is_core_of = ROOT }
						}
						transfer_state_to = FRA
					}
					ROOT = { end_puppet = FRA }
					every_country = {
						limit = {
							has_war_with = FRA
						}
						white_peace = FRA
					}
					if = {
						limit = {
							FRG = { exists = yes }
						}
						ROOT = { end_puppet = FRG }
						FRA = { annex_country = { target = FRG transfer_troops = yes } }
					}
				}
			}
			if = {
				limit = {
					ROOT = { has_country_flag = defeat_britain_flag }
				}
				if = {
					limit = {
						ENG = { has_country_flag = second_great_war_loser }
					}
					ENG = { drop_cosmetic_tag = yes }
					every_state = {
						limit = {
							is_owned_by = ROOT
							is_core_of = ENG
							NOT = { is_core_of = ROOT }
						}
						transfer_state_to = ENG
					}
					ROOT = { end_puppet = ENG }
					every_country = {
						limit = {
							has_war_with = ENG
						}
						white_peace = ENG
					}
					if = {
						limit = {
							WLS = { exists = yes }
						}
						ROOT = { end_puppet = WLS }
						ENG = { annex_country = { target = WLS transfer_troops = yes } }
					}
					if = {
						limit = {
							SCO = { exists = yes }
						}
						ROOT = { end_puppet = SCO }
						ENG = { annex_country = { target = SCO transfer_troops = yes } }
					}
				}
			}
			if = {
				limit = {
					ROOT = { has_country_flag = defeat_usa_flag }
				}
				if = {
					limit = {
						USA = { has_country_flag = second_great_war_loser }
					}
					every_state = {
						limit = {
							is_owned_by = ROOT
							is_core_of = USA
							NOT = { is_core_of = ROOT }
						}
						transfer_state_to = USA
					}
					ROOT = { end_puppet = USA }
					ROOT = { end_puppet = SFF }
					ROOT = { end_puppet = UWS }
					every_country = {
						limit = {
							has_war_with = USA
						}
						white_peace = USA
					}
					every_country = {
						limit = {
							has_war_with = SFF
						}
						white_peace = SFF
					}
					every_country = {
						limit = {
							has_war_with = UWS
						}
						white_peace = UWS
					}
				}
			}
			if = {
				limit = {
					ROOT = { has_country_flag = defeat_italy_flag }
				}
				if = {
					limit = {
						ITA = { has_country_flag = second_great_war_loser }
					}
					if = {
						limit = {
							NOT = { has_global_flag = split_the_italy }
						}
						every_state = {
							limit = {
								is_owned_by = ROOT
								is_core_of = ITA
								NOT = { is_core_of = ROOT }
							}
							transfer_state_to = ITA
						}
						ROOT = { end_puppet = ENG }
					}
					every_country = {
						limit = {
							has_war_with = ITA
						}
						white_peace = ITA
					}
					if = {
						limit = {
							has_global_flag = split_the_italy
						}
					}
					ITA = {
						annex_country = { target = EMI transfer_troops = yes }
						annex_country = { target = TOS transfer_troops = yes }
						annex_country = { target = TTS transfer_troops = yes }
						annex_country = { target = SPM transfer_troops = yes }
					}
					every_state = {
						limit = {
							is_owned_by = PAP
							OR = {
								state = 161
								state = 938
								state = 2
							}
						}
						transfer_state_to = ITA
					}
					every_state = {
						limit = {
							is_owned_by = ITA
						}
						add_core_of = ITA
					}
				}
			}
			if = {
				limit = {
					original_tag = GER
					NOT = { has_global_flag = second_world_war }
					SOV = { has_country_flag = anti_russia_war_loser }
					RUS = { exists = no }
					NOT = { has_global_flag = you_cant_stop_now_flag }
				}
				if = {
					limit = {
						MOS = { exists = yes }
					}
					SOV = { annex_country = { target = MOS transfer_troops = no } }
				}
				if = {
					limit = {
						WOL = { exists = yes }
					}
					SOV = { annex_country = { target = WOL transfer_troops = no } }
				}
			}
			if = {
				limit = {
					original_tag = JAP
				}
				if = {
					limit = {
						OR = {
							SOV = { has_country_flag = anti_russia_war_loser }
							RUS = { has_country_flag = anti_russia_war_loser }
						}
					}
					if = {
						limit = {
							FER = { exists = yes }
						}
						if = {
							limit = {
								SOV = { exists = yes }
							}
							SOV = { annex_country = { target = FER transfer_troops = no } }
						}
						else_if = {
							limit = {
								RUS = { exists = yes }
							}
							RUS = { annex_country = { target = FER transfer_troops = no } }
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = GER
					any_enemy_country = {
						original_tag = AUH
					}
					has_global_flag = Deutscher_Krieg
					AUH = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				clr_global_flag = Deutscher_Krieg
				ITA = {
					if = {
						limit = {
							has_country_flag = join_brothers_war
						}
						leave_faction = yes
					}
				}
				ROM = {
					if = {
						limit = {
							has_country_flag = join_brothers_war
							is_in_faction_with = GER
						}
						leave_faction = yes
					}
				}
				AUH = {
					country_event = AUH.34
					set_country_flag = victor_of_deutscher_Krieg
					save_global_event_target_as = leader_of_reichspakt
				}
			}
			if = {
				limit = {
					original_tag = ITA
					any_enemy_country = {
						original_tag = AUH
					}
					has_country_flag = join_brothers_war
					AUH = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				ITA = {
					if = {
						limit = {
							has_country_flag = join_brothers_war
							is_in_faction_with = GER
						}
						leave_faction = yes
					}
					every_state = {
						limit = {
							is_owned_by = ITA
							is_core_of = ETH
						}
						transfer_state_to = ETH
					}
					every_state = {
						limit = {
							is_owned_by = ITA
							is_core_of = SOM
						}
						transfer_state_to = SOM
					}
					every_state = {
						limit = {
							is_owned_by = ITA
							is_core_of = LBA
						}
						transfer_state_to = LBA
					}
				}
				AUH = {
					country_event = AUH.36
				}
			}
			if = {
				limit = {
					original_tag = AUH
					has_global_flag = Deutscher_Krieg
					GER = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				GER = {
					country_event = Germany.77
				}
			}
			if = {
				limit = {
					original_tag = SOM
					has_global_flag = ita_som_war
					ITA = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				ITA = {
					news_event = italy.27
				}
			}
			if = {
				limit = {
					original_tag = SPR
					has_global_flag = FRA_SPR_revolution_flag
					FRA = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				FRA = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
							SPR = { exists = yes }
						}
						set_autonomy = {
							target = SPR
							autonomous_state = autonomy_satellite
							freedom_level = 0.5
						}
						else = {
							puppet = SPR
						}
					}
				}
				SPR = {
					create_country_leader = {
						name = "SPR_juan_garcia_oliver"
						picture = "gfx/leaders/SPR/SPR_juan_garcia_oliver.png" 
						ideology = syndicalism
					}
				}
				every_state = {
					limit = {
						is_owned_by = SPR
						is_core_of = MOR
					}
					if = {
						limit = {
							MOR = { exists = yes }
						}
						transfer_state_to = MOR
					}
					else = {
						transfer_state_to = FRA
					}
				}
				every_state = {
					limit = {
						is_owned_by = SPR
						OR = {
							is_core_of = WES
							state = 178
							state = 297
						}
					}
					transfer_state_to = FRA
				}
				clr_global_flag = FRA_SPR_revolution_flag
			}
			if = {
				limit = {
					original_tag = ITA
					has_global_flag = FRA_ITA_revolution_flag
					FRA = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				FRA = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
							ITA = { exists = yes }
						}
						set_autonomy = {
							target = ITA
							autonomous_state = autonomy_satellite
							freedom_level = 0.5
						}
						else = {
							puppet = ITA
						}
					}
				}
				ITA = {
					create_country_leader = {
						name = "ITA_edmondo_pelusini"
						picture = "gfx/leaders/ITA/ITA_edmondo_pelusini.png" 
						ideology = syndicalism
					}
				}
				every_state = {
					limit = {
						is_owned_by = ITA
						is_core_of = LBA
					}
					transfer_state_to = LBA
				}
				every_state = {
					limit = {
						is_owned_by = ITA
						is_core_of = ERI
					}
					transfer_state_to = ERI
				}
				every_state = {
					limit = {
						is_owned_by = ITA
						is_core_of = ETH
					}
					transfer_state_to = ETH
				}
				every_state = {
					limit = {
						is_owned_by = ITA
						OR = {
							is_core_of = SOM
							is_core_of = GAL
						}
					}
					transfer_state_to = SOM
				}
				clr_global_flag = FRA_ITA_revolution_flag
			}
			if = {
				limit = {
					original_tag = SWI
					has_global_flag = FRA_SWI_revolution_flag
					FRA = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				FRA = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
							SWI = { exists = yes }
						}
						set_autonomy = {
							target = SWI
							autonomous_state = autonomy_satellite
							freedom_level = 0.5
						}
						else = {
							puppet = SWI
						}
					}
				}
				SWI = {
					create_country_leader = {
						name = "SWI_robert_grimm"
						picture = "gfx/leaders/SWI/SWI_robert_grimm.png" 
						ideology = syndicalism
					}
				}
				clr_global_flag = FRA_SWI_revolution_flag
			}
			if = {
				limit = {
					original_tag = PER
					has_global_flag = PER_TUR_war
					TUR = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				TUR = {
					country_event = turkey.37
				}
			}
			if = {
				limit = {
					original_tag = BUL
					has_global_flag = fourth_balkan_war
					GRE = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
					NOT = {
						OR = {
							is_in_faction_with = GER
							is_in_faction_with = FRA
						}
					}
				}
				clr_global_flag = fourth_balkan_war
				every_country = {
					limit = {
						OR = {
							is_in_faction_with = GRE
							is_subject_of = GRE
						}
						has_war_with = BUL
					}
					white_peace = BUL
					set_country_flag = victory_against_bulgaria
				}
				BUL = {
					add_popularity = {
						ideology = neutrality
						popularity = -0.2
					}
					add_popularity = {
						ideology = fascism
						popularity = 0.1
					}
					add_popularity = {
						ideology = communism
						popularity = 0.1
					}
					add_war_support = -0.1
					add_stability = -0.1
					remove_ideas = victor_of_the_Balkan_War
					add_ideas = BUL_idea_second_national_catastrophe
					set_country_flag = fall_of_bul
				}
				GRE = { country_event = greece.15 remove_ideas = GRE_anti_Bulgarian_sentiment }
			}
			if = {
				limit = {
					original_tag = GRE
					has_global_flag = fourth_balkan_war
					BUL = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				clr_global_flag = fourth_balkan_war
				news_event = greece.22
			}
			if = {
				limit = {
					original_tag = GRE
					has_global_flag = greece_ottoman_war
					TUR = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				clr_global_flag = greece_ottoman_war
				GRE = {
					remove_ideas = GRE_anti_Ottoman_sentiment
				}
			}
			if = {
				limit = {
					original_tag = TUR
					has_global_flag = greece_ottoman_war
					GRE = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = TUR
						OR = {
							is_core_of = GRE
							is_claimed_by = GRE
						}
					}
					transfer_state_to = GRE
				}
				GRE = {
					remove_ideas = GRE_anti_Ottoman_sentiment
				}
				clr_global_flag = greece_ottoman_war
				TUR = { set_capital = { state = 49 } }
			}
			#Ukraine Civilwar
			if = {
				limit = {
					original_tag = UPR
					has_global_flag = ukraine_civil_war
					UKR = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = UPR
						is_controlled_by = UKR
					}
					transfer_state_to = UKR
				}
				every_state = {
					limit = {
						is_owned_by = UPR
						is_controlled_by = USS
					}
					transfer_state_to = USS
				}
			}
			if = {
				limit = {
					original_tag = USS
					has_global_flag = ukraine_civil_war
					UKR = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = USS
						is_controlled_by = UKR
					}
					transfer_state_to = UKR
				}
				every_state = {
					limit = {
						is_owned_by = USS
						is_controlled_by = UPR
					}
					transfer_state_to = UPR
				}
			}
			if = {
				limit = {
					original_tag = UKR
					has_global_flag = ukraine_civil_war
					UPR = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_owned_by = UKR
						is_controlled_by = UPR
					}
					transfer_state_to = UPR
				}
				every_state = {
					limit = {
						is_owned_by = UKR
						is_controlled_by = USS
					}
					transfer_state_to = USS
				}
			}
			#SPR Civilwar
			if = {
				limit = {
					tag = SPA
					has_global_flag = spanish_civil_war
					SPD = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_core_of = SPA
					}
					remove_core_of = SPA
				}
				41 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				165 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				166 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				167 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				168 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				169 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				170 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				171 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				172 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				173 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				174 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				175 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				176 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				788 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				789 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				790 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				791 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				792 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				793 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				794 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				SPD = { annex_country = { target = SPA transfer_troops = yes } }
				SPD = { news_event = spain.8 }
			}
			if = {
				limit = {
					tag = SPD
					has_global_flag = spanish_civil_war
					SPA = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_core_of = SPR
					}
					remove_core_of = SPR
					add_core_of = SPA
				}
				41 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				165 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				166 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				167 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				168 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				169 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				170 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				171 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				172 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				173 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				174 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				175 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				176 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				788 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				789 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				790 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				791 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				792 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				793 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				794 = {
					remove_dynamic_modifier = {
						modifier = unplanned_offensive
					}
				}
				SPA = { annex_country = { target = SPD transfer_troops = yes } }
				SPA = { news_event = spain.7 }
			}
			#French Civilwar
			if = {
				limit = {
					tag = FRS
					FRA = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_core_of = FRS
					}
					remove_core_of = FRS
				}
				FRA = { annex_country = { target = FRS transfer_troops = yes } country_event = france.46 }
			}
			if = {
				limit = {
					tag = FRA
					FRS = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_state = {
					limit = {
						is_core_of = FRA
					}
					remove_core_of = FRA
				}
				FRS = { annex_country = { target = FRA transfer_troops = yes } country_event = france.46 }
			}
			#Mukden incident
			if = {
				limit = {
					original_tag = FNG
					FNG = { is_in_faction = no }
					JAP = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				every_country = {
					limit = {
						has_war_with = FNG
						OR = {
							original_tag = JAP
							is_in_faction_with = JAP
							is_subject_of = JAP
						}
					}
					white_peace = FNG
				}
				clr_global_flag = JAP_Mukden_incident_flag
				set_global_flag = end_of_mukden_incident_flag
				JAP = {
					if = {
						limit = {
							OR = {
								has_dlc = "Together for Victory"
								has_dlc = "Waking the Tiger"
							}
						}
						set_autonomy = {
							target = MAN
							autonomous_state = autonomy_wtt_imperial_protectorate
							freedom_level = 0.5
						}
						else = {
							puppet = MAN
						}
					}
				}
				every_state = {
					limit = {
						is_owned_by = FNG
						OR = {
							state = 716
							state = 328
							state = 717
							state = 610
							state = 715
							state = 714
							state = 761
							state = 961
							state = 999
							state = 1000
						}
					}
					add_core_of = MAN
					transfer_state_to = MAN
				}
				JAP = {
					if = {
						limit = {
							OR = {
								has_dlc = "Together for Victory"
								has_dlc = "Waking the Tiger"
							}
						}
						set_autonomy = {
							target = MEN
							autonomous_state = autonomy_wtt_imperial_protectorate
							freedom_level = 0.5
						}
						else = {
							puppet = MEN
						}
					}
				}
				every_state = {
					limit = {
						is_owned_by = FNG
						OR = {
							state = 612
							state = 611
						}
					}
					add_core_of = MEN
					transfer_state_to = MEN
				}
				every_state = {
					limit = {
						is_owned_by = FNG
						state = 609
					}
					transfer_state_to = JAP
				}
				if = {
					limit = {
						FNG = { has_war_with = CHI }
					}
					every_country = {
						limit = {
							has_war_with = FNG
							OR = {
								original_tag = CHI
								is_in_faction_with = CHI
								is_subject_of = CHI
							}
						}
						white_peace = FNG
					}
					every_state = {
						limit = {
							is_core_of = FNG
						}
						remove_core_of = FNG
						add_core_of = CHI
					}
					CHI = { annex_country = { target = FNG transfer_troops = yes } }
				}
				JAP = { country_event = japan_wr.16 }
				if = {
					limit = {
						NOT = { FNG = { has_war_with = CHI } }
					}
					FNG = { news_event = { id = wr_news.2 days = 14 } }
				}
			}
			#KMT civil war
			if = {
				limit = {
					tag = CHI
					has_global_flag = kmt_civil_war
					CHR = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				CHR = { annex_country = { target = CHI transfer_troops = yes } }
				every_state = {
					limit = {
						is_core_of = CHI
					}
					remove_core_of = CHI
				}
				clr_global_flag = kmt_civil_war
			}
			if = {
				limit = {
					tag = CHR
					has_global_flag = spanish_civil_war
					CHI = {
						has_war_with = PREV
						has_capitulated = no
					}
				}
				CHI = { annex_country = { target = CHR transfer_troops = yes } }
				every_state = {
					limit = {
						is_core_of = CHR
					}
					remove_core_of = CHR
				}
				clr_global_flag = kmt_civil_war
			}
			#
			if = {
				limit = {
					tag = SOS
					has_global_flag = soviet_civilwar_focus
					SOT = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOT = {
					annex_country = {
						target = SOS
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOB }
					}
					SOT = { news_event = Soviet.42 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOB
					has_global_flag = soviet_civilwar_focus
					SOT = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOT = {
					annex_country = {
						target = SOB
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOS }
					}
					SOT = { news_event = Soviet.42 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOT
					has_global_flag = soviet_civilwar_focus
					SOS = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOS = {
					annex_country = {
						target = SOT
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOB }
					}
					SOS = { news_event = Soviet.46 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOB
					has_global_flag = soviet_civilwar_focus
					SOS = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOS = {
					annex_country = {
						target = SOB
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						has_global_flag = soviet_civilwar_by_workers_opposition_flag
					}
					add_ideas = home_of_revolution
					set_division_template_lock = {
						division_template = "Red Riflemen"
						is_locked = no
					}
					set_division_template_lock = {
						division_template = "Women Brigades"
						is_locked = no
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOT }
					}
					SOS = { news_event = Soviet.46 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOT
					SOB = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOB = {
					annex_country = {
						target = SOT
						transfer_troops = yes
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOS }
					}
					SOB = { news_event = Soviet.47 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			if = {
				limit = {
					tag = SOS
					has_global_flag = soviet_civilwar_focus
					SOB = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				SOB = {
					annex_country = {
						target = SOS
						transfer_troops = yes
					}
					if = {
						limit = {
							has_completed_focus = SOV_the_second_october_revolution
						}
						add_ideas = postwar_reconstruction_high
						create_faction = workers_opposition
					}
				}
				if = {
					limit = {
						NOT = { country_exists = SOT }
					}
					SOB = { news_event = Soviet.47 }
					clr_global_flag = soviet_civilwar_focus
				}
				every_country = {
					limit = {
						has_idea = Soviet_Civil_War
					}
					remove_ideas = Soviet_Civil_War
				}
			}
			#- 
			if = {
				limit = {
					tag = ETH
					has_global_flag = Second_Italo_Ethiopian_War
					ITA = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				ITA = { annex_country = { target = ETH transfer_troops = no } }
				ITA = {
					news_event = italy.49
				}
			}
			if = {
				limit = {
					tag = TUR
					has_global_flag = second_ita_otto_war_refuse
					ITA = {
						has_war_with = PREV
						is_subject = no
						has_capitulated = no
					}
				}
				ITA = {
					news_event = italy.38
				}
			}
			#
			if = {
				limit = {
					original_tag = JAP
				}
				if = {
					limit = {
						FROM = { is_subject = no }
					}
					FROM = { set_country_flag = defeat_japan_flag }
					else = {
						every_country = {
							limit = {
								has_subject = FROM
							}
							set_country_flag = defeat_japan_flag
						}
					}
				}
				JAP = { end_puppet = KAM }
				KAM = {
					retire_character = KAM_yasuyo_yamasaki
					recruit_character = KAM_grigory_kireyev
					set_politics = {
						ruling_party = neutrality
						last_election = "1936.1.1"
						election_frequency = 48
						elections_allowed = yes
					}
					set_popularities = {
						democratic = 60
						fascism = 0
						communism = 20
						neutrality = 20
					}
				}
				clr_global_flag = second_Sino_Japanese_war_flag
				set_global_flag = for_conference_about_japs
				if = {
					limit = {
						SOV = {
							has_war_with = JAP
						}
					}
					every_state = {
						limit = {
							OR = {
								is_core_of = SOV
								is_claimed_by = SOV
							}
						}
						remove_core_of = JAP
						remove_claim_by = JAP
					}
					every_state = {
						limit = {
							OR = {
								state = 537
								state = 555
							}
						}
						add_core_of = SOV
						remove_core_of = JAP
					}
				}
				if = {
					limit = {
						RUS = {
							has_war_with = JAP
						}
					}
					every_state = {
						limit = {
							OR = {
								is_core_of = RUS
								is_claimed_by = RUS
							}
						}
						remove_core_of = JAP
						remove_claim_by = JAP
					}
					every_state = {
						limit = {
							OR = {
								state = 537
								state = 555
							}
						}
						add_core_of = RUS
						remove_core_of = JAP
					}
				}
				if = {
					limit = {
						CHI = {
							has_war_with = JAP
							is_subject = no
							has_capitulated = no
						}
					}
					every_state = {
						limit = {
							is_owned_by = JAP
							OR = {
								is_chinese_area = yes
								state = 524
							}
						}
						transfer_state_to = CHI
					}
					UNF = { dismantle_faction = yes }
					#CHI = { country_event = { id = china_wr.25 days = 7 } }
				}
				if = {
					limit = {
						JAP = { has_country_flag = sino_japanese_war_winner }
					}
					hidden_effect = {
						every_country = {
							limit = {
								exists = yes
							}
							every_country = {
								limit = {
									has_country_flag = sino_japanese_war_loser
								}
								remove_wargoal = {
									type = all
									target = PREV 
								}
							}
						}
						every_country = {
							limit = {
								OR = {
									is_in_faction_with = ROOT
									is_subject_of = ROOT
									has_country_flag = sino_japanese_war_loser
								}
							}
							every_country = {
								limit = {
									has_country_flag = sino_japanese_war_winner
								}
								remove_wargoal = {
									type = all
									target = PREV 
								}
							}
						}
					}
					every_country = {
						limit = { has_country_flag = sino_japanese_war_loser }
						drop_cosmetic_tag = yes
						every_country = {
							limit = {
								has_war_with = PREV
							}
							white_peace = PREV
						}
					}
					every_country = {
						limit = {
							is_subject_of = JAP
							has_country_flag = sino_japanese_war_loser
						}
						JAP = { end_puppet = PREV }
					}
					every_country = {
						limit = { has_country_flag = sino_japanese_war_loser }
						clr_country_flag = sino_japanese_war_loser
						leave_faction = yes
						if = {
							limit = {
								NOT = { original_tag = CHI }
							}
							set_politics = {
								ruling_party = neutrality
								elections_allowed = no
							}
						}
					}
					GSM = {
						retire_ideology_leader = communism
						retire_ideology_leader = fascism
						retire_ideology_leader = democratic
						retire_ideology_leader = neutrality
					}
					CHI = {
						retire_ideology_leader = communism
						retire_ideology_leader = fascism
						retire_ideology_leader = democratic
						retire_ideology_leader = neutrality
						set_politics = {
							ruling_party = democratic
							elections_allowed = yes
							election_frequency = 48
							long_name = CHI_JAP_party_long
							name = CHI_JAP_party
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = CHI
					has_war_with = JAP
					has_global_flag = second_Sino_Japanese_war_flag
				}
				clr_global_flag = second_Sino_Japanese_war_flag
				if = {
					limit = {
						CHI = { is_faction_leader = yes }
					}
					CHI = { dismantle_faction = yes }
				}
				else_if = {
					limit = {
						CHI = {
							is_faction_leader = no
							is_in_faction = yes
						}
					}
					every_country = {
						limit = {
							is_chinese_country = yes
							has_war_with = jap
						}
						leave_faction = yes
					}
				}
				every_country = {
					limit = {
						is_chinese_country = yes
						has_war_with = jap
					}
					set_country_flag = sino_japanese_war_loser
					white_peace = {
						tag = JAP
						message = unconditional_surrender_of_CHI
					}
				}
				every_country = {
					limit = {
						has_war_with = CHI
					}
					white_peace = CHI
				}
				every_country = {
					limit = {
						OR = {
							original_tag = JAP
							is_in_faction_with = JAP
							is_subject_of = JAP
						}
					}
					set_country_flag = sino_japanese_war_winner
				}
				CHI_defeat_annex = yes
				JAP = {
					country_event = japan_wr.40
					set_country_flag = victory_against_china
				}
				CHI = {
					set_party_name = {
						ideology = neutrality
						long_name = CHI_JAP_party_long
						name = CHI_JAP_party
					}
					set_party_name = {
						ideology = democratic
						long_name = CHI_JAP_party_long
						name = CHI_JAP_party
					}
					set_party_name = {
						ideology = fascism
						long_name = CHI_JAP_party_long
						name = CHI_JAP_party
					}
					set_party_name = {
						ideology = communism
						long_name = CHI_JAP_party_long
						name = CHI_JAP_party
					}
				}
			}
			#for achievements
			if = {
				limit = {
					FROM = {
						original_tag = GER
					}
					original_tag = FRA
				}
				FROM = { set_country_flag = another_schlieffen_plan_flag }
			}
			if = {
				limit = {
					FROM = {
						original_tag = JAP
					}
					original_tag = GER
				}
				FROM = { set_country_flag = yellow_peril_flag }
			}
			if = {
				limit = {
					has_war_with = FRA
					OR = {
						original_tag = SOV
						original_tag = RUS
					}
					FRA = { has_country_flag = second_great_war_winner }
				}
				FRA = { set_country_flag = revenge_of_1812_flag }
			}
		}
	}
	on_peaceconference_started = {
		effect = {
		}
	}
	on_peaceconference_ended = {
		effect = {
			if = {
				limit = {
					has_global_flag = for_conference_about_japs
				}
			}
			clr_global_flag = for_conference_about_japs
			every_country = {
				limit = {
					has_country_flag = defeat_japan_flag
				}
				clr_country_flag = defeat_japan_flag
			}
			if = {
				limit = {
					FROM = { original_tag = JAP }
				}
				set_global_flag = japan_lost_the_war
			}
		}
	}
	on_puppet = {
		effect = {
			if = {
				limit = {
					original_tag = FRA
					is_subject_of = GER
					NOT = {
						any_country = {
							has_cosmetic_tag = FRG
						}
					}
				}
				if = {
					limit = {
						GER = {
							NOT = {
								has_government = communism
							}
						}
					}
					set_cosmetic_tag = FRG
					else = {
						set_cosmetic_tag = FRA_com
					}
				}
				if = {
					limit = {
						GER = {
							has_government = neutrality
						}
					}
					create_country_leader = {
						name = "GER_victoria"
						picture = "gfx/leaders/GER/GER_Victoria_Louise.png"
						ideology = autocracy
						traits = { Imperial_connections }
					}
				}
				create_country_leader = {
					name = "GER_alfred_jodl"
					picture = "GFX_portrait_GER_alfred_jodl" 
					ideology = fascism_ideology
					traits = { foreign_leader allegiance_to_germany }
				}
				create_country_leader = {
					name = "FRA_gouvernement_provisoire"
					picture = "gfx/leaders/FRA/FRA_provisional_government.png"
					ideology = conservatism
					traits = {
						allegiance_to_germany
					}
				}
				create_country_leader = {
					name = "FRA_gouvernement_provisoire"
					picture = "gfx/leaders/FRA/FRA_provisional_government.png"
					ideology = syndicalism
					traits = {
						allegiance_to_germany
					}
				}
				if = {
					limit = {
						GER = {
							has_government = neutrality
						}
					}
					set_party_name = {
						ideology = neutrality
						long_name = GER_neutrality_party_long
						name = GER_neutrality_party
					}
				}
				set_party_name = {
					ideology = democratic
					long_name = FRA_gouvernement_provisoire_long
					name = FRA_gouvernement_provisoire
				}
				set_party_name = {
					ideology = communism
					long_name = FRA_gouvernement_provisoire_long
					name = FRA_gouvernement_provisoire
				}
				set_party_name = {
					ideology = fascism
					long_name = GER_Army_Military_Government_long
					name = GER_Army_Military_Government
				}
			}
			if = {
				limit = {
					original_tag = JAP
				}
				NOT = {
					any_country = {
						has_cosmetic_tag = TSC
					}
				}
				set_cosmetic_tag = TSC
				create_country_leader = {
					name = "JAP_The_Supreme_Commander"
					picture = "gfx/leaders/JAP/JAP_The_Supreme_Commander.png"
					ideology = despotism
				}
				create_country_leader = {
					name = "JAP_The_Supreme_Commander"
					picture = "gfx/leaders/JAP/JAP_The_Supreme_Commander.png"
					ideology = fascism_ideology
				}
				create_country_leader = {
					name = "JAP_The_Supreme_Commander"
					picture = "gfx/leaders/JAP/JAP_The_Supreme_Commander.png"
					ideology = conservatism
				}
				create_country_leader = {
					name = "JAP_The_Supreme_Commander"
					picture = "gfx/leaders/JAP/JAP_The_Supreme_Commander.png"
					ideology = marxism
				}
			}
		}
	}
	on_declare_war = {
		effect = {
			if = {
				limit = {
					OR = {
						AND = {
							original_tag = FNG
							FROM = { original_tag = JAP }
						}
						AND = {
							original_tag = JAP
							FROM = { original_tag = FNG }
						}
					}
				}
				FNG = { set_country_flag = releation_with_jap_is_over }
			}
		}
	}
	on_civil_war_end = {
		effect = {
			if = {
				limit = {
					ROOT = { tag = USC }
					FROM = { original_tag = UKR }
				}
				SOV = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = USC
							autonomous_state = autonomy_protected_state
							freedom_level = 0.4
						}
						else = {
							puppet = USC
						}
					}
				}
			}
			if = {
				limit = {
					ROOT = { tag = BLC }
					FROM = { original_tag = BLR }
				}
				SOV = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = BLC
							autonomous_state = autonomy_protected_state
							freedom_level = 0.4
						}
						else = {
							puppet = BLC
						}
					}
				}
			}
			if = {
				limit = {
					ROOT = { has_idea = with_soviet_idea }
				}
				SOV = { add_to_faction = ROOT }
			}
		}
	}
	on_join_faction = {
		effect = {
			if = {
				limit = {
					ROOT = { original_tag = FNG }
					FROM = { original_tag = JAP }
				}
				FNG = { set_country_flag = FNG_hanjian }
			}
		}
	}
	
	on_state_control_changed = {
		effect = {
			### Integration Check
			FROM.FROM = {
				if = {
					limit = {
						has_variable = can_integrate_@ROOT
						NOT = { is_core_of = ROOT }
						impassable = no
					}
					start_state_integration_resistance = yes
				}
				else = {
					clear_state_integration_resistance = yes
				}
			}
		}
	}
}