on_actions = {
	on_capitulation = {
		effect = {
			#동북군
			if = {
				limit = {
					tag = NEA
					has_war_with = MAN
				}
				MAN = {
					annex_country = { target = NEA transfer_troops = no }
					set_capital = {
					  state = 716
					  remember_old_capital = no
					}
				}
				add_victory_points = {
					province = 11771
					value = 21
				}
			}
			#몽골전쟁
			if = {
				limit = {
					original_tag = MON
					any_enemy_country = {
						original_tag = SEF
					}
				}
				set_global_flag = SOV_won_win_MON_war_flag
				if = {
					limit = {
						SEF = { has_war_with = MAN }
					}
					MAN = {
						white_peace = {
							tag = SEF
							message = sef_man_bad_tt
						}
						set_country_flag = MAN_failed_in_mongolian_war
					}
				}
				SIK = {
					drop_cosmetic_tag = yes
				}
				every_state = {
					limit = {
						is_owned_by = SEF
						is_core_of = TAN
					}
					transfer_state_to = TAN
				}
				if = {
					limit = {
						SIK = { exists = yes }
					}
					every_state = {
						limit = {
							is_owned_by = SEF
							is_core_of = SIK
						}
						transfer_state_to = SIK
					}
					else = {
						every_state = {
							limit = {
								is_owned_by = SEF
								state = 618
							}
							transfer_state_to = CHI
						}
					}
				}
				every_state = {
					limit = {
						is_owned_by = SEF
						is_core_of = MON
					}
					transfer_state_to = MON
				}
				every_state = {
					limit = {
						is_owned_by = MAN
						is_core_of = MON
					}
					transfer_state_to = MON
				}
				SOV = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
							TAN = { exists = yes }
						}
						set_autonomy = {
							target = TAN
							autonomous_state = autonomy_puppet
							freedom_level = 0.5
						}
						else = {
							puppet = TAN
						}
					}
					if = {
						limit = {
							has_dlc = "Together for Victory"
							MON = { exists = yes }
						}
						set_autonomy = {
							target = MON
							autonomous_state = autonomy_satellite
							freedom_level = 0.5
						}
						else = {
							puppet = MON
						}
					}
					if = {
						limit = {
							has_dlc = "Together for Victory"
							SIK = { exists = yes }
						}
						set_autonomy = {
							target = SIK
							autonomous_state = autonomy_satellite
							freedom_level = 0.5
						}
						else = {
							puppet = SIK
						}
					}
				}
			}
			if = {
				limit = {
					original_tag = SEF
					any_enemy_country = {
						original_tag = MON
					}
				}
				set_global_flag = MAN_won_win_MON_war_flag
				SIK = {
					drop_cosmetic_tag = yes
				}
				if = {
					limit = {
						SIK = { exists = yes }
					}
					every_state = {
						limit = {
							is_owned_by = SEF
							is_core_of = SIK
						}
						transfer_state_to = SIK
					}
					else = {
						every_state = {
							limit = {
								is_owned_by = SEF
								state = 618
							}
							transfer_state_to = CHI
						}
					}
				}
				every_state = {
					limit = {
						is_owned_by = SEF
						is_core_of = MON
					}
					transfer_state_to = MON
				}
				every_state = {
					limit = {
						is_owned_by = SEF
						is_core_of = TAN
					}
					transfer_state_to = TAN
				}
				SOV = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
							TAN = { exists = yes }
						}
						set_autonomy = {
							target = TAN
							autonomous_state = autonomy_puppet
							freedom_level = 0.5
						}
						else = {
							puppet = TAN
						}
					}
				}
				MON = {
					remove_ideas = MON_soviet_influence
				}
				every_state = {
					limit = {
						is_owned_by = MAN
						is_core_of = MON
					}
					transfer_state_to = MON
				}
				MAN = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
							MON = { exists = yes }
						}
						set_autonomy = {
							target = MON
							autonomous_state = autonomy_puppet
							freedom_level = 0.5
						}
						else = {
							puppet = MON
						}
					}
				}
			}
			#북방수복전쟁
			if = {
				limit = {
					original_tag = SIK
					any_enemy_country = {
						original_tag = CHI
					}
					has_global_flag = Attack_SIK_for_on_action_and_ai_flag
				}
				clr_global_flag = Attack_SIK_for_on_action_and_ai_flag
				CHI = { clr_country_flag = CHI_northern_pacification_flag }
				every_country = {
					limit = {
						OR = {
							original_tag = CHI
							is_subject_of = CHI
							is_in_faction_with = CHI
						}
					}
					white_peace = {
						tag = SIK
					}
				}
				CHI = {
					annex_country = {
						target = SIK
						transfer_troops = no
					}
					country_event = china_wr.148
				}
				SOV = { country_event = china_wr.155 }
			}
			if = {
				limit = {
					original_tag = MON
					any_enemy_country = {
						original_tag = CHI
					}
					has_global_flag = Attack_MON_for_on_action_and_ai_flag
				}
				clr_global_flag = Attack_MON_for_on_action_and_ai_flag
				CHI = { clr_country_flag = CHI_northern_pacification_flag }
				every_country = {
					limit = {
						OR = {
							original_tag = CHI
							is_subject_of = CHI
							is_in_faction_with = CHI
						}
					}
					white_peace = {
						tag = MON
					}
				}
				CHI = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
							MON = { exists = yes }
						}
						set_autonomy = {
							target = MON
							autonomous_state = autonomy_autonomous_provincial_government
							freedom_level = 0.5
						}
						else = {
							puppet = MON
						}
					}
					country_event = china_wr.150
				}
				SOV = { country_event = china_wr.157 }
			}
			#중국내전
			if = {
				limit = {
					original_tag = KMT
					any_enemy_country = {
						original_tag = CHI
					}
				}
				CHI = {
					annex_country = {
						target = KMT
						transfer_troops = yes
					}
					country_event = { id = china_wr.88 days = 7 }
					country_event = { id = china_wr.87 days = 15 }
					news_event = china_wr.180
					clear_variable = CHI_military_discontent_var
					drop_cosmetic_tag = yes
				}
				every_state = {
					limit = {
						is_core_of = KMT
					}
					remove_core_of = KMT
				}
				every_state = {
					limit = {
						OR = {
							state = 752
							state = 751
							state = 605
							state = 748
							state = 1004
							state = 753
							state = 620
							state = 85
							state = 1013
							state = 744
							state = 1014
							state = 607
							state = 325
							state = 599
							state = 603
							state = 754
							state = 591
							state = 594
							state = 592
							state = 593
							state = 1005
							state = 602
							state = 705
							state = 1007
							state = 600
							state = 1006
							state = 1009
							state = 595
							state = 1008
							state = 1010
							state = 749
							state = 596
							state = 613
							state = 960
							state = 1011
							state = 606
							state = 598
							state = 1015
						}
					}
					remove_dynamic_modifier = { modifier = CHI_unplanned_offensive }
					remove_dynamic_modifier = { modifier = Aftermath_of_the_Sichuan_Famine }
				}
				clr_global_flag = chinese_civil_war
			}
			if = {
				limit = {
					original_tag = CHI
					any_enemy_country = {
						original_tag = KMT
					}
				}
				KMT = {
					annex_country = {
						target = CHI
						transfer_troops = yes
					}
					country_event = { id = china_wr.75 days = 5 }
					news_event = china_wr.181
					set_cosmetic_tag = KMT_CHI
				}
				if = {
					limit = {
						SHX = { is_subject_of = CHI }
					}
					KMT = {
						annex_country = {
							target = SHX
							transfer_troops = yes
						}
					}
				}
				if = {
					limit = {
						PRC = { is_subject_of = CHI }
					}
					KMT = {
						annex_country = {
							target = PRC
							transfer_troops = yes
						}
					}
				}
				every_state = {
					limit = {
						is_core_of = CHI
					}
					remove_core_of = CHI
				}
				every_state = {
					limit = {
						OR = {
							state = 752
							state = 751
							state = 605
							state = 748
							state = 1004
							state = 753
							state = 620
							state = 85
							state = 1013
							state = 744
							state = 1014
							state = 607
							state = 325
							state = 599
							state = 603
							state = 754
							state = 591
							state = 594
							state = 592
							state = 593
							state = 1005
							state = 602
							state = 705
							state = 1007
							state = 600
							state = 1006
							state = 1009
							state = 595
							state = 1008
							state = 1010
							state = 749
							state = 596
							state = 613
							state = 960
							state = 1011
							state = 606
							state = 598
							state = 1015
						}
					}
					remove_dynamic_modifier = { modifier = CHI_unplanned_offensive }
					remove_dynamic_modifier = { modifier = Aftermath_of_the_Sichuan_Famine }
				}
				clr_global_flag = chinese_civil_war
			}
			if = {
				limit = {
					original_tag = NPA
					any_enemy_country = {
						original_tag = KMT
					}
				}
				KMT = {
					annex_country = {
						target = NPA
						transfer_troops = yes
					}
				}
				every_state = {
					limit = {
						is_core_of = NPA
					}
					remove_core_of = NPA
				}
			}
			if = {
				limit = {
					original_tag = PRC
					any_enemy_country = {
						original_tag = KMT
					}
				}
				KMT = {
					annex_country = {
						target = PRC
						transfer_troops = yes
					}
				}
				every_state = {
					limit = {
						is_core_of = PRC
					}
					remove_core_of = PRC
				}
			}
			if = {
				limit = {
					original_tag = SHX
					any_enemy_country = {
						original_tag = KMT
					}
				}
				KMT = {
					annex_country = {
						target = SHX
						transfer_troops = yes
					}
				}
				every_state = {
					limit = {
						is_core_of = SHX
					}
					remove_core_of = SHX
				}
			}
			if = {
				limit = {
					original_tag = SCH
					any_enemy_country = {
						original_tag = SKM
					}
				}
				KMT = {
					annex_country = {
						target = SCH
						transfer_troops = yes
					}
					annex_country = {
						target = SKM
						transfer_troops = yes
					}
				}
				every_state = {
					limit = {
						is_core_of = SCH
					}
					remove_core_of = SCH
				}
				every_state = {
					limit = {
						is_core_of = SKM
					}
					remove_core_of = SKM
				}
			}
			if = {
				limit = {
					original_tag = SKM
					any_enemy_country = {
						original_tag = SCH
					}
				}
				CHI = {
					annex_country = {
						target = SKM
						transfer_troops = yes
					}
					annex_country = {
						target = SCH
						transfer_troops = yes
					}
				}
				every_state = {
					limit = {
						is_core_of = SKM
					}
					remove_core_of = SKM
				}
				every_state = {
					limit = {
						is_core_of = SCH
					}
					remove_core_of = SCH
				}
			}
		}
	}
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						OR = {
							state = 608
							state = 614
							state = 597
							state = 1014
							state = 607
							state = 613
							state = 960
							state = 1011
							state = 85
							state = 750
							state = 602
							state = 1006
							state = 1005
							state = 593
							state = 592
						}
					}
				}
				if = {
					limit = {
						ROOT = { original_tag = CHI }
						has_global_flag = chinese_civil_war
						CHI = { has_variable = CHI_military_discontent_var }
					}
					FROM.FROM = {
						CHI = { country_event = china_wr.1000 }
					}
				}
				if = {
					limit = {
						ROOT = { original_tag = KMT }
						has_global_flag = chinese_civil_war
						CHI = { has_variable = CHI_military_discontent_var }
					}
					FROM.FROM = {
						CHI = { country_event = china_wr.1001 }
					}
				}
			}
		}
	}
}